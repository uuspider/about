<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="shortcur icon" href="/images/i32.ico" type="image/x-icon" />
  <title>NumPy guide</title>
  <meta name="author" content="uuspider" />
  <meta name="description" content="about uuspider" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" >
  <link rel="stylesheet" href="//css/styles.css" />

</head>
<body>

  <style type="text/css">
pre {
  padding:8px 15px;
  background: #f8f8f8;  
  border:1px solid #e5e5e5;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  -ms-border-radius: 6px;
  -o-border-radius: 6px;
  border-radius: 6px;
  overflow-x: auto;
}
pre,code {
  background:#e8f5fe;color:#000;
}
</style>

<h2 id="numpy-guide">NumPy guide</h2>

<p>参考：<a href="http://wiki.scipy.org/Tentative_NumPy_Tutorial" target="_blank">NumPy tutorial</a>,  <a href="http://reverland.org/python/2012/09/07/matplotlib-tutorial/" target="_blank">Matplotlib tutorial</a>,  <a href="http://dormouse.github.io/pandas.html" target="_blank">pandas tutorial</a>,  <a href="https://web.archive.org/web/20120225082123/http://kr.cs.ait.ac.th/~radok/math/mat7/stepsa.htm" target="_blank">Numerical Analysis</a></p>

<h2 id="top"></h2>

<hr />

<h3 id="basics">ndarray数组</h3>

<p>NumPy以n维数组(ndarray)的形式处理数据，称之为ndarray对象。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; a = np.array([[1,2,3],[4,5,6]])
&gt;&gt;&gt; a
array([[1, 2, 3],
       [4, 5, 6]])
&gt;&gt;&gt; a.shape
(2,3)
</code></pre>
</div>

<p><code class="highlighter-rouge">a.shape</code>返回了ndarray的维度，类似的，ndarray还有一些其它的属性：</p>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">a.ndim</code></td>
      <td>a轴的个数(秩)，如上例中，a.ndim为2</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.shape</code></td>
      <td>a的维度，如上例的二维数组，a.shape为(2,3)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.size</code></td>
      <td>a元素的总个数</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.dtype</code></td>
      <td>a中元素的类型</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.itemsize</code></td>
      <td>a中每个元素的字节大小</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.data</code></td>
      <td>a中元素的缓冲区</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.T</code></td>
      <td>a的转置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.H</code></td>
      <td>a的共轭转置</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.I</code></td>
      <td>a的逆</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.trace</code></td>
      <td>a的迹，即对角线元素之和</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.det(a)</code></td>
      <td>矩阵a的行列式</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.norm（a, ord=None)</code></td>
      <td>矩阵a的范数</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.eig(a)</code></td>
      <td>矩阵a的特征值和特征向量</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.cond(a, p=None)</code></td>
      <td>矩阵a的条件数</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.inv(a)</code></td>
      <td>矩阵a的逆矩阵</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="section">创建数组</h3>

<p>上文中已经通过<code class="highlighter-rouge">array</code>创建了一个数组，常用的数组创建函数有：<code class="highlighter-rouge">array</code>, <code class="highlighter-rouge">asarray</code>, <code class="highlighter-rouge">arange</code>, <code class="highlighter-rouge">ones</code>, <code class="highlighter-rouge">ones_like</code>, <code class="highlighter-rouge">zeros</code>, <code class="highlighter-rouge">zeros_like</code>, <code class="highlighter-rouge">empty</code>, <code class="highlighter-rouge">empty_like</code>, <code class="highlighter-rouge">eye</code>, <code class="highlighter-rouge">identity</code>等。</p>

<h3 id="section-1">数据类型</h3>

<p>创建数组过程中还可以指定dtype，如</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; a = ones( (2,3,4), dtype=int16 )
</code></pre>
</div>

<p>NumPy的数据类型有：</p>

<table>
  <tbody>
    <tr>
      <td>bool</td>
      <td>用一个Bit存储的布尔类型（True或False）</td>
    </tr>
    <tr>
      <td>inti</td>
      <td>由所在平台决定其大小的整数（一般为int32或int64）</td>
    </tr>
    <tr>
      <td>int8</td>
      <td>一个字节大小，-128 至 127</td>
    </tr>
    <tr>
      <td>int16</td>
      <td>整数，-32768 至 32767</td>
    </tr>
    <tr>
      <td>int32</td>
      <td>整数，-2 E 31 至 2 E 32 -1</td>
    </tr>
    <tr>
      <td>int64</td>
      <td>整数，-2 E 63 至 2 E 63 - 1</td>
    </tr>
    <tr>
      <td>uint8</td>
      <td>无符号整数，0 至 255</td>
    </tr>
    <tr>
      <td>uint16</td>
      <td>无符号整数，0 至 65535</td>
    </tr>
    <tr>
      <td>uint32</td>
      <td>无符号整数，0 至 2 E 32 - 1</td>
    </tr>
    <tr>
      <td>uint64</td>
      <td>无符号整数，0 至 2 E 64 - 1</td>
    </tr>
    <tr>
      <td>float16</td>
      <td>半精度浮点数：16位，正负号1位，指数5位，精度10位</td>
    </tr>
    <tr>
      <td>float32</td>
      <td>单精度浮点数：32位，正负号1位，指数8位，精度23位</td>
    </tr>
    <tr>
      <td>float64或float</td>
      <td>双精度浮点数：64位，正负号1位，指数11位，精度52位</td>
    </tr>
    <tr>
      <td>complex64</td>
      <td>复数，分别用两个32位浮点数表示实部和虚部</td>
    </tr>
    <tr>
      <td>complex128或complex</td>
      <td>复数，分别用两个64位浮点数表示实部和虚部</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="ufunc">一元运算</h3>

<p>一元运算会对ndarray中的每个元素分别进行运算，称为broadcasting，常用的运算包括<code class="highlighter-rouge">abs</code>, <code class="highlighter-rouge">fabs</code>, <code class="highlighter-rouge">sqrt</code>(开平方), <code class="highlighter-rouge">square</code>(二次方), <code class="highlighter-rouge">exp</code>(e的x次幂), <code class="highlighter-rouge">log</code>, <code class="highlighter-rouge">log10</code>, <code class="highlighter-rouge">log2</code>, <code class="highlighter-rouge">log1P</code>, <code class="highlighter-rouge">sign</code>, <code class="highlighter-rouge">ceil</code>(向上取整), <code class="highlighter-rouge">floor</code>(向下取整), <code class="highlighter-rouge">rint</code>(四舍五入), <code class="highlighter-rouge">modf</code>(分离整数和小数部分，分别返回), <code class="highlighter-rouge">isnan
</code>(判断是否数字), <code class="highlighter-rouge">isfinite</code>(判断是否无穷), <code class="highlighter-rouge">isinf</code>(判断是否有限), <code class="highlighter-rouge">cos</code>, <code class="highlighter-rouge">cosh</code>, <code class="highlighter-rouge">sin</code>, <code class="highlighter-rouge">sinh</code>, <code class="highlighter-rouge">tan</code>, <code class="highlighter-rouge">tanh</code>, <code class="highlighter-rouge">arccos</code>, <code class="highlighter-rouge">arccosh</code>, <code class="highlighter-rouge">arcsin</code>, <code class="highlighter-rouge">arcsinh</code>, <code class="highlighter-rouge">arctan</code>, <code class="highlighter-rouge">arctanh</code>, <code class="highlighter-rouge">logical_not</code>, 使用<code class="highlighter-rouge">help</code>或<code class="highlighter-rouge">dir</code>可查看其详细用法。</p>

<h3 id="bufunc">二元运算</h3>

<p>ndarray的二元运算也是对元素分别运算，常用的有<code class="highlighter-rouge">add</code>, <code class="highlighter-rouge">subtract</code>, <code class="highlighter-rouge">multiply</code>, <code class="highlighter-rouge">divide</code>, <code class="highlighter-rouge">floor_divide</code>, <code class="highlighter-rouge">power</code>, <code class="highlighter-rouge">maximum</code>, <code class="highlighter-rouge">fmax</code>, <code class="highlighter-rouge">minimum</code>, <code class="highlighter-rouge">fmin</code>, <code class="highlighter-rouge">mod</code>, <code class="highlighter-rouge">copysign</code>, <code class="highlighter-rouge">greater</code>, <code class="highlighter-rouge">greater_equal</code>, <code class="highlighter-rouge">less</code>, <code class="highlighter-rouge">less_equal</code>, <code class="highlighter-rouge">equal</code>, <code class="highlighter-rouge">not_equal</code>, <code class="highlighter-rouge">logical_and</code>, <code class="highlighter-rouge">logical_or</code>, <code class="highlighter-rouge">logical_xor</code>, 如：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; np.equal(a, a)
</code></pre>
</div>

<p>使用<code class="highlighter-rouge">help</code>或<code class="highlighter-rouge">dir</code>可查看其详细用法。</p>

<h3 id="section-2">数据导入与导出</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; a = np.loadtxt('sample.txt', delimiter=',')
&gt;&gt;&gt; np.savetxt('sample_new.txt', a, delimiter=',')
</code></pre>
</div>

<h3 id="section-3">统计方法</h3>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">sum</code></td>
      <td>全部/某轴向元素之和</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">mean</code></td>
      <td>算术平均值</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">std</code>, <code class="highlighter-rouge">var</code></td>
      <td>标准差/方差</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">min</code>, <code class="highlighter-rouge">max</code></td>
      <td>最大/最小元素</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">argmin</code>, <code class="highlighter-rouge">argmax</code></td>
      <td>最大/最小元素的索引</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">cumsum</code>, <code class="highlighter-rouge">cumprod</code></td>
      <td>所有元素之和/之积</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="section-4">排序</h3>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">arr.sort(1)</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.unique(a)</code></td>
      <td>去掉a中的重复元素，返回排序后结果</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.in1d(A, B)</code></td>
      <td>测试B中元素是否存在于A中</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.intersect1d(A, B)</code></td>
      <td>返回A，B共有元素</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.union1d(A, B)</code></td>
      <td>返回A，B合集</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.setdiff1d(A, B)</code></td>
      <td>返回在A中，不在B中的元素</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.setxor1d(A, B)</code></td>
      <td>返回存在于A或B，但不同时存在于A，B中的元素</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="linalg">linalg函数</h3>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">np.diag()</code></td>
      <td>返回矩阵对角线元素；返回以一维数组元素为对角线的方阵</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.dot()</code></td>
      <td>矩阵乘法；内积</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.trace()</code></td>
      <td>对角线之和；迹</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.det()</code></td>
      <td>行列式</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.eig()</code></td>
      <td>本征值、本征向量</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.inv()</code></td>
      <td>逆</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.pinv()</code></td>
      <td>Moore-Penrose伪逆</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.qr()</code></td>
      <td>QR分解(Q为正交矩阵，R为上三角矩阵，A=QR，若R对角线元素为正，则分解唯一)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.svd()</code></td>
      <td>奇异值分解</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.solve()</code></td>
      <td>Ax=b，计算x</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.linalg.lstsq()</code></td>
      <td>y=mx+c，最小二乘解</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>线性方程组的解法：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; a = np.array([[3,1], [1,2]])
&gt;&gt;&gt; b = np.array([9,8])
&gt;&gt;&gt; x = np.linalg.solve(a, b) #
&gt;&gt;&gt; x
array([ 2.,  3.])
</code></pre>
</div>

<p>验证计算结果：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; np.allclose(np.dot(a, x), b)
True
</code></pre>
</div>

<p>最小二乘法实例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; x = np.array([0, 1, 2, 3])
&gt;&gt;&gt; y = np.array([-1, 0.2, 0.9, 2.1])
&gt;&gt;&gt; A = np.vstack([x, np.ones(len(x))]).T #
&gt;&gt;&gt; A
array([[ 0.,  1.],
       [ 1.,  1.],
       [ 2.,  1.],
       [ 3.,  1.]])
&gt;&gt;&gt; m, c = np.linalg.lstsq(A, y)[0] #
&gt;&gt;&gt; print(m, c)
1.0 -0.95
</code></pre>
</div>

<p>使用matplotlib可以画出拟合曲线：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.plot(x, y, 'o', label='Original data', markersize=10)
&gt;&gt;&gt; plt.plot(x, m*x + c, 'r', label='Fitted line')
&gt;&gt;&gt; plt.legend()
&gt;&gt;&gt; plt.show()
</code></pre>
</div>

<h3 id="random">random函数</h3>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">np.random.seed()</code></td>
      <td>给出随机数生成器种子</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.permutation()</code></td>
      <td>随机排列，可给出范围或种子</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.shuffle()</code></td>
      <td>对序列随机排列</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.rand()</code></td>
      <td>均匀分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.randint()</code></td>
      <td>指定上下限内的随机整数</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.randn()</code></td>
      <td>正态分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.binomal()</code></td>
      <td>二项分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.normal()</code></td>
      <td>正态(高斯)分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.beta()</code></td>
      <td>Beta分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.gamma()</code></td>
      <td>Gamma分布</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">np.random.uniform()</code></td>
      <td>[0,1)均匀分布</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>使用<code class="highlighter-rouge">help</code>或<code class="highlighter-rouge">dir</code>可查看更多函数及其详细用法。</p>

<h3 id="where">where</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; result = np.where(cond, A, B)
</code></pre>
</div>

<p>cond是表达式、bool值或矩阵，详见<code class="highlighter-rouge">help(np.where)</code>。</p>

<h3 id="bool">bool矩阵</h3>

<table>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">a.any()</code></td>
      <td>a中是否存在bool值为1/True的元素</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">a.all()</code></td>
      <td>a中元素是否全部为1/True</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">(a&gt;0).sum()</code></td>
      <td>计算符合条件<code class="highlighter-rouge">a&gt;0</code>的元素之和</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>[<a href="#top">TOP</a>]</strong></p>

<hr />




<div  style="display:none"><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1264508560'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s13.cnzz.com/z_stat.php%3Fid%3D1264508560%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script></div>
</body>
</html>
