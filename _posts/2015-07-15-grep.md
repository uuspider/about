---
layout: post
title: Regular expression & grep
---
## grep 与 正则表达式



***

grep 是 Linux 中一个用来进行对文本内容进行搜索和匹配的命令行工具，是 "Global Regular Expression Print" 的简写，顾名思义，grep 与 "Regular Expression" 是密不可分的，学习 grep ，关键就是掌握正则表达式的用法。

## 正则表达式

正则表达式使用一系列特殊字符构建了一套规则，用于匹配字符串，这些特殊字符称为元字符，下面列出了最常用的一些元字符。

### `.` (一个点): 匹配除换行符之外的任意单个字符。

    $ grep 'r..t' /etc/passwd
    
`r..t`可以匹配root, reet, r  t等，但不能匹配rat, rot等。

### `*`: 匹配前一个字符0次或任意多次。

    $ grep 'r*t' /etc/passwd
    
输出含有t, rt, rrt等字符串的行。

`.*`: 匹配任意次“`.`”，也就是匹配任意长度的任意字符。

    $ grep 'r.*t' /etc/passwd
    
`r.*t`表示“字母r+任意长度字符+字母t”。

### `{n,m}`: 匹配前一个字符的至少n次，最多m次。

    $ grep 'ro{2}t' /etc/passwd
    
匹配字母'o'两次。

    $ grep 'ro{2,}t' /etc/passwd

匹配字母'o'至少两次。

    $ grep 'ro{,2}t' /etc/passwd
    
匹配字母'o'最多两次。
    
### `^`: 匹配行首字符串。

    $ grep '^root' /etc/passwd
    
### `$`: 匹配行尾字符串。
    
    $ grep '^root.*h$' /etc/passwd
    
匹配以'root'开头，'h'结尾的行。`^$`匹配空行。

### `[ ]`: 匹配括号内出现的任意单个字符。

`[ABCD]`匹配A、B、C、D任一字母；`[A-Z]`匹配任意一个大写字母；`[^A-D]`匹配一个不是大写字母的字符(`^`在`[ ]`内时表示取反)。

    $ grep '^1[358][0-9]{9}' contact.txt
    
这条命令可以匹配手机号码。

### `\`: 转义符，用于对特殊符号的“转义”。

    $ grep '022[\ \-][1-9][0-9]{7}' contact.txt
    
匹配类似"022 87401033"、"022-87401033"这样的电话号码。

### `\<`和`\>`: 界定单词的左边界和右边界。

`\<hello`匹配以“hello”开头的单词，`hello\>`匹配以“hello”结尾的单词，`\<hello\>可以精确匹配“hello”。

上面提到的这些元字符通用性好，易读易写，足够满足一般的应用。此外，还有匹配换行符的`\n`，匹配回车符的`\r`，匹配制表符的`\t`，匹配换页符的`\f`，匹配任意空白字符的`\s`以及匹配任意非空白字符的`\S`。





***

假设要匹配的字是“中文”，查找到它的utf-8编码和gb2312编码分别是E4B8ADE69687和D6D0CEC4

    grep -rnP "\xE4\xB8\xAD\xE6\x96\x87|\xD6\xD0\xCE\xC4" file.txt
    
