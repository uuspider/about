---
layout: post
title: Introduction to sed
---
## sed 介绍

<h2 id="top"></h2>

***

*   [文本替换](#replace)

*   [sed 选项](#option)


***

和`grep`一样，`sed`也是按行处理文件；不同的是，`sed`命令具有编辑功能，是一种“流编辑器”(stream editor)，因此，除了使用[正则表达式](http://about.uuspider.com/2015/07/15/grep.html#basic)匹配目标字符，还需要明确编辑类型，并指定编辑范围，这些功能使得`sed`比`grep`命令的格式更复杂一些。

对文本的编辑动作，包括替换、插入、删除等，下面我们通过“替换”动作来了解`sed`命令的操作方法。

## 文本替换  {#replace}

    $ sed 's/root/ROOT/' /etc/passwd

这条命令是将`/etc/passwd`中的“root”替换为“ROOT”，其中`s`是“替换”命令符，`/`是分隔符。

    $ sed '1,5s/root/ROOT/' /etc/passwd
    
这是将第2行到第5行中的“root”替换为“ROOT”。需要指出的是，`sed`默认只替换一行中的第一个匹配项，如果要替换该行所有匹配项，需要在命令后加上`g`：

    $ sed '1,5s/root/ROOT/g'  /etc/passwd
    
如果只替换一行的第二个匹配项，应该这样写：

    $ sed '1,5s/root/ROOT/2'  /etc/passwd
    
如果替换一行中第二个和以后的匹配项，应该这样写：

    $ sed '1,5s/root/ROOT/2g'  /etc/passwd
    
如果替换一行中第一个和第二个匹配项，可以这样写：

    $ sed -e '1,5s/root/ROOT/1;1,5s/root/ROOT/1'  /etc/passwd
    
这里我们使用了一个选项`-e`，表示允许表达式有多个执行动作，动作之间用";"分开。注意：通过这个例子可以发现多个动作是相继进行的，而不是同时进行的，所以两个动作都是寻找当前行第一个匹配项进行替换。
    
`sed`处理后文件后会全部输出到屏幕，这样不方便查看处理结果，有时候我们更需要`sed`只输出经过处理的行，这时应该使用选项`-n`。

上面几条命令中，`sed`仅将处理过的内容输出到屏幕，而不会影响文件本身，如果希望该结果覆盖原文件，应该使用选项`-i`。

## sed 选项 {#option}

    $ sed [选项] 表达式 [FILE...]

|选项:||
|:---|:---|
|`-e`:|允许表达式有多个动作，动作之间以";"分开|
|`-n`:|只显示经过`sed`处理过的行|
|`-i`:|将`sed`输出结果保存到原文件|

## sed 动作 {#cmd}

和上文的[替换](#replace)动作相比，下面这些动作更简单更容易理解。

### 添加行 {#append_insert}




















