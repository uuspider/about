---
layout: post
title: json & csv tools
---
## JSON & CSV 工具

参考：[ csvkit docs ][ref1]{:target="_blank"},  [ JSON & CSV ][ref2]{:target="_blank"},  [ jq manual ][ref3]{:target="_blank"}, [ introducing json ][ref4]{:target="_blank"}

[ref1]:https://csvkit.readthedocs.org
[ref2]:http://blog.lyuehh.com/json/2014/01/01/json-process-in-command-line.html
[ref3]:https://stedolan.github.io/jq/manual/
[ref4]:http://www.json.org/json-zh.html

<h2 id="top"></h2>

***

## json 格式说明 {#json}

JSON (JavaScript Object Notation) 是一种文本格式，容易读，也便于写；JSON采用了类似于C语言家族的数据格式，多种语言(C, C++, C#, Java, JavaScript, Perl, Python等)都可以方便地解析和生成这种格式，因此，JSON作为一种理想的数据交换格式得到广泛应用。

JSON 基于两种数据结构：

### “名称/值”对的集合 ( A collection of name/value pairs )

在不同的语言中，它可以是对象(object), 记录(record), 结构(struct), 字典(dictionary), 哈希表(hash table), 有键列表(keyed list), 或者关联数组 (associative array)，本文统称之为对象(object)，其格式为`{"string1":"value1", "string2":"value2"}`，如：

> {"uid":"yemo","name":"张航","gender":"男","location":"马来西亚","agree":2751,"thanks":518,"ask":5,"answer":47,"fo":293,"fan":2061,"business":"互联网","bio":"独立开发者   ","description":"自强不息。","avatar":"http://pic3.zhimg.com/330ccd2da56786419a53ca408b3f6a9e_l.jpg"}

### 值的有序列表 ( An ordered list of values )

通常就是数组(array)，其格式为`[value1, value2]`。

对象和数组的`value`可以是字符串、数值、true、false、null，也可以是对象、数组，也就是说这两种结构之间可以相互嵌套。

字符串需要使用双引号`""`扩起来，可以包含任意长度的unicode字符，以下字符需要转义处理：

|:---|:---|
|`\"`|`"`|
|`\\`|`\`|
|`\/`|`/`|
|`\b`|退格|
|`\f`|换页|
|`\n`|换行|
|`\r`|回车|
|`\t`|制表符|
|`\u`|后接4位十六进制数字|

<br>

JSON 是一种松散、灵活的格式，目前并没有形成统一的标准。

## csv 格式说明 {#csv}

CSV (Comma-Separated Values) 也是一种文本格式，由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。

CSV格式比JSON更早，但也没有形成统一的标准，只有一些简单的规则，如：

每一条记录自成一行，不跨行，不留空行；

可设列名，列名要写在文件第一行；

即使某条记录中有字段为空，也要用分隔符指定其位置；

不支持特殊字符，`"`和`,`要转义。

**[[TOP](#top)]**

***

## jq {#jq}

`jq`是用C编写的json文件处理工具，参见 <http://stedolan.github.io/jq/>  。

    $ curl https://api.douban.com/v2/book/1220562 | jq '.'

格式化输出json文件的全部内容。

    $ curl https://api.douban.com/v2/book/1220562 | jq '.title'

输出json文件中'title'的值。

    $ curl https://api.douban.com/v2/event/list?loc=beijing | jq '.events[].owner.name'

输出json文件中'events[]'中所有'owner'下'name'的值。

**[[TOP](#top)]**

***

## csvkit {#csvkit}

csvkit 包含了python编写的一系列csv格式处理工具，参见 <https://github.com/jehiah/json2csv> 。

### Input {#tocsv}

#### in2csv

`in2csv`用于将其它格式的数据转成csv格式，支持的输入格式包括：csv, dbf, fixed, geojson, json, ndjson, xls, xlsx。

    $ in2csv -e gbk -f json file.json > file.csv

将gbk编码的json格式文件转为csv格式。

#### sql2csv

导出SQL数据为csv格式文件。

    $ sql2csv --db "sqlite:///dummy.db" --query "select * from test"

### Processing {#processing}

#### csvclean






### Output {#output}





**[[TOP](#top)]**

***