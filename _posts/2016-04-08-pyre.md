---
layout: post
title: sys, os, io, list & re of python
---
## python: 文本操作

参考：[Regular-Expressions in python][ref1]{:target="_blank"}

[ref1]:http://www.cnblogs.com/huxi/archive/2010/07/04/1771073.html

<h2 id="top"></h2>

***

*   [sys & os](#sys)
*   [文件操作](#io)
    *   [基本操作](#rw)
    *   [按行迭代](#readline)
*   [字符串处理](#list)
*   [正则表达式](#re)
    *   [基本功能](#basic)
    *   [元字符](#posix)
    *   [匹配模式](#pattern)

***

## sys & os 模块 {#sys}

sys和os是python标准库中的两个模块，可以通过

    >>> help(sys)
    >>> help(os)

查看模块中的函数、变量等详细信息。

|:---|:---|
|`sys.argv[0]`|当前脚本或程序名称|
|`sys.argv[i]`(i>0)|命令行参数|
|`os.name`|当前操作系统|
|`os.getcwd()`|当前工作目录|
|`os.listdir()`|指定目录下的所有文件和目录名|
|`os.remove()`|删除文件|
|`os.system()`|运行shell命令|
|`os.path.split()`|返回路径的目录名和文件名|
|`os.path.isfile()`|检验路径是否为文件|
|`os.path.isdir()`|检验路径是否为目录|
|`os.path.exists()`|检验路径是否存在|

<br>

**[[TOP](#top)]**

***

## 文件操作 {#io}

### 文件的读、写和关闭 {#rw}

    >>> f = open('lesson1.txt', 'w')
    >>> f.write('Good morning, class. ')
    >>> f.write('Godd morning, teacher.')
    >>> f.write('Sit down, please.')
    >>> f.write('My name is Han Meimei.')
    >>> f.close()

这里的`'w'`表示写模式，常用的还有`r`读模式，`a`追加模式，`b`二进制模式，`+`读/写模式。

    >>> f = open('lesson1.txt', 'r')
    >>> f.read(13)
    'Good morning,'
    >>> f.read()
    ' class.Good morning, teacher.Sit down, please.My name is Han Meimei.'
    >>> f.close()
    
    >>> f = open('lesson1.txt', 'w')
    >>> f.writelines(['Good morning, class.\n','Good morning, teacher.\n','Sit down, please.\n','My name is Han Meimei.'])
    >>> f.close()
    
    >>> f = open('lesson1.txt', 'r')
    >>> f.readlines()
    ['Good morning, class.\n', 'Good morning, teacher.\n', 'Sit down, please.\n', 'My name is Han Meimei.']
    >>> f.close()
    
    >>> f = open('hi.txt', 'r')
    >>> f.readline()
    'Good morning, class.\n'
    >>> f.readline()
    'Good morning, teacher.\n'
    >>> f.close()

### 按行操作 {#readline}

    >>> for line in open(lesson1.txt):
    ...     process(line)

也可以用这种方法按行处理标准输入：

    >>> import sys
    >>> for line in sys.stdin:
    ...     process(line)

**[[TOP](#top)]**

***

## 字符串处理 {#list}

    >>> val = 'Good morning, class.'
    >>> val.split(',')
    ['Good morning', ' class.']
    >>> 'o' in val
    True
    >>> val.index('o')
    1
    >>> val.find('o')
    1
    >>> val.rfind('o')
    6
    >>> val.count('o')
    3
    >>> val.replace(',', '-')
    'Goodmorning- class.'
    >>> val.replace(',', '')
    'Goodmorning class.'
    >>> val.lower()
    'goodmorning- class.'
    >>> val.upper()
    'GOOD MORNING, CLASS.'
    >>> pieces = [x.strip() for x in val.split(',')]
    >>> pieces
    ['Good morning', 'class.']
    >>> ','.join(pieces)
    'Goodmorning,class.'

这些内置的字符串方法可以完成大部分的日常操作，更复杂的字符串处理需要借助于正则表达式模块`re`。

**[[TOP](#top)]**

***

## 正则表达式 {#re}

### 基本功能 {#basic}
    >>> import re
    >>> if re.search('o', val): #在字符串中查找
    ...     print "Found."
    ... 
    Found.
    >>> if re.match('Good', val): #从字符串首开始匹配
    ...     print "Found."
    ... 
    Found.
    >>> re.split('[, ]+', val) #根据匹配项分割字符串
    ['Good', 'morning', 'class.']
    >>> re.sub('o', 'O', val) #替换匹配项
    'GOOd mOrning, class.'

有时候，字符串转义会给正则匹配带来不小的麻烦，python提供了“原生字符串”用于避免此类问题：

    >>> re.search(r'o', val) != None #注意r
    True

注意：python2默认未采用unicode，因此最好使用`u`标记，即`ur'o'`，python3默认采用了unicode，因此只需使用`r`标记。

注意：python可能会提示脚本中出现的utf-8字符无法识别，此时应在.py文件首部加上：

    # encoding = utf-8

### 元字符 {#posix}

python正则表达式中常见的[元字符](http://about.uuspider.com/2015/07/15/grep.html#basic){:target="_blank"}有：

|:---|:---|
|`.`|匹配任意字符|
|`[ ]`|匹配字符组中任意一个字符|
|`\d`|匹配数字，即[0-9]，补集为`\D`|
|`\w`|匹配数字和字母，即[0-9a-zA-Z]，补集为`\W`|
|`\s`|匹配空白字符，包括`\t`,`\n`,`\v`,`\f`,`\r`等，补集为`\S`|
|`^`|匹配行首|
|`$`|匹配行尾|
|`\b`|匹配单词的边界，补集为`\B`|
|`(?=re)`|前向肯定界定符|
|`(?!re)`|前向否定界定符|
|`(?<=re)`|反向肯定界定符|
|`(?!<re)`|反向否定界定符|
|`(re_a|re_b)`|匹配re_a或re_b|
|`?`,`*`,`+`,`{n, m}`|分别匹配0-1,>=0,>=1,n-m次，后加`?`表示非贪婪模式|

<br>

### 匹配模式 {#pattern}

|:---|:---|:---|
|`re.I(IGNORECASE)`|`i`|不区分大小写|
|`re.X(VERBOSE)`|`x`|注释|
|`re.M(MULTILINE)`|`m`|多行|
|`re.S(DOTALL)`|`s`|单行|
|`re.U(UNICODE)`|`u`|unicode模式|
|`re.A(ASCII)`|`a`|ascii模式，只支持python3|

<br>

匹配模式的使用方法：

    >>> re.search('g', val) != None
    >>> re.search('(?i)g', val) != None
    >>> re.search('g', val, re.IGNORECASE) != None

**[[TOP](#top)]**

***